## 总线概述

总线型连接是为了解决I/O设备和主机之间连接的灵活性问题。

### 基本概念

**定义**

能为多个部件分时共享的公共信息传送线路。分时和共享是总线的两个特点。

共享指总线上可以挂接多个部件。

**总线设备**

分为主设备和从设备。

**特性**

指机械特性、电气特性、功能特性、时间特性。

### 总线分类

**片内总线**

CPU内部寄存器之间、寄存器与ALU之间的公共连接线。

**系统总线**

计算机各功能部件（CPU、主存、I/O接口）之间相互连接的总线。

又分为数据、地址和控制总线。

**通信总线**

在计算机系统之间或计算机与其他系统之间传送信息的总线，有时也称外部总线。

另外按时序还分为同步和异步总线，按数据传输格式分为串行和并行总线。

### 系统总线的结构

**单总线结构**

将CPU、主存、I/O设备都挂在一组总线上。

**双总线结构**

一条是主存总线，用于CPU、主存和通道之间传送数据；另一条是I/O总线，用于在多个外部设备和通道之间传送数据。

**三总线结构**

主存总线、I/O总线、直接内存访问(DMA)总线。

DMA总线用于内存和高速外设之间直接传送数据，提高了I/O设备的性能。

### 总线的性能指标

* 总线传输周期：一次总线操作所需的时间
* 总线时钟周期：即机器的时钟周期
* 总线的工作频率：总线上各种操作的频率，为总线周期的倒数。实际上指1s内传输几次数据。
* 总线的时钟频率
* 总线宽度
* 总线带宽：总线的最大数据传输率
* 总线复用：一种信号线在不同时间传输不同的信息
* 信号线数：地址总线、数据总线和控制总线3种总线数的总和。

## *总线仲裁

为了解决多个主设备同时竞争总线控制权的问题。

### 集中仲裁方式

总线控制逻辑集中于一个设备（例如CPU）中。将所有总线请求集中起来，利用特定的裁决算法进行裁决。集中仲裁方式有以下几种：

**链式查询方式**

BG总线允许线、BR总线请求线、BS总线忙线

**计数器定时查询方式**

BR总线请求线、BS总线忙线、地址设备线

优先次序可以改变，这种方式对电路故障没那么敏感。

**独立请求方式**

每个设备都有自己的BG总线允许线、BR总线请求线。

总线控制器按照一定的优先次序批准某个部件的请求。

响应速度快但控制线数量多，总线控制逻辑更复杂。

### 分布仲裁方式

没有中央仲裁器，每个主模块都有自己的仲裁号和仲裁器。

## 总线操作和定时

总线定时指总线在双方交换数据的过程中需要时间上配合关系的控制，实质上是一种协议。主要有**同步和异步**两种基本定时方式。

### 总线传输的4个阶段

* 申请分配阶段
* 寻址阶段
* 传输阶段
* 结束阶段

### 同步定时方式

系统采用一个统一的时钟信号来协调发送和接收双方的传送定时关系。时钟产生相等的时间间隔，每个间隔构成一个总线周期。一个总线周期发送方和接收方可以进行一次数据传送。

传输速度较快。主从设备强制同步。适用于纵线长度较短及总线所接部件的存取时间较接近的系统。

### 异步定时方式

依靠传送双方相互制约的握手信号来实现定时控制。

总线周期长度可变，控制方式稍复杂，速度较慢。

* 不互锁方式
* 半互锁方式
* 全互锁方式

## 总线标准

* ISA：最早输出现的系统总线
* EISA
* VESA：32位，应用于多媒体
* PCI：外部设备互联
* PCIe
* AGP：加速图形接口
* RS-232：串行通信总线
* USB
* PCMCIA
* IDE
* SCSI
* SATA
