## 存储器概述

### 分类

**按层次分**

* 主存储器：内存，CPU可直接随机对其访问
* 辅助存储器：外存，是主存储器的后援存储器，用来存放当前暂时不用的程序和数据，以及需要永久保存的数据
* 高速缓冲存储器：位于主存和CPU之间，用来存放正在执行的程序段和数据，存取速度可与CPU的速度匹配

**按存取方式**

* 随机存储器(RAM)：又分为SRAM和DRAM
* 只读存储器(ROM)：断电保留内容，随机读写特性，但写入比读取慢得多。
* 串行访问存储器：对存储单元进行读写操作时，需要按其物理位置的先后顺序寻址。

**按信息的可保存性分**

易失性：断电后存储信息消失。

非易失性：断电后信息仍然保持。

### 性能指标

**存储容量**

=存储字数*字长；存储字数表示存储器地址空间的大小，字长表示一次存取操作的数据量。

**单位成本**

每位价格=总成本/总容量

**存储速度**

* 存取时间：从启动一次存储器操作到完成该操作所经历的时间
* 存取周期：存储器进行一次完整的读写操作所需要的全部时间
* 主存带宽：又称数据传输率，每秒从主存进出信息的最大数量

存取时间不等于存储周期，通常存储周期大于存储时间，因为对于任何一种存储器，读写操作后总要有一段恢复内部状态的复原时间。

## 存储器的层次化结构

多级存储系统，用来解决存储器大容量、高速度和低成本3个相互制约的矛盾。

* Cache-主存：解决CPU和主存速度不匹配的问题

* 主存-辅存：解决存储系统的容量问题

辅存要通过主存和CPU交换信息，主存与CPU、Cache、辅存都能交换信息。

主存和Cache之间的数据调动是由硬件自动完成的，对**所有程序员**都透明；主存和辅存之间的数据调动是由硬件和操作系统共同完成的，对**应用程序员**透明。

## 半导体随机存储器

主存由DRAM实现，Cache由SRAM实现，都属于易失性存储器。

### SRAM和DRAM

**SRAM**

把存放一个二进制位的物理器件称为**存储元**，是存储器最基本的构件。地址码相同的多个存储元构成一个**存储单元**。若干存储单元的集合构成**存储体**。

SRAM用双稳态触发器（6个晶体管）来记忆信息，是非破坏性读取。

SRAM存储速度快，但集成度低，功耗较大，一般用来作高速缓存。

**DRAM**

利用存储元电路中栅极电容上的电荷来存储信息，只使用一个晶体管，比SRAM密度高很多。

DRAM采用地址复用技术，地址线是原来的1/2，地址信号分行、列两次传送。

DRAM相对于SRAM来说容易集成、价位低、容量大，但存取速度慢。

DRAM电容上的电荷一般只能维持1-2ms，即使电源不断电，信息也会自动消失。为此必须每隔一定时间刷新，时间一般设为**2ms**，称为**刷新周期**，常用刷新方式有：

* 集中刷新：在一个刷新周期内取一段固定时间依次对存储器的所有行进行逐一再生，在此期间停止对存储器的读写操作，称为**死时间**，又称访存死区。优点是读写操作不受刷新影响，缺点是在集中刷新期间不能进行读写操作。
* 分散刷新：把对每行的刷新分散到各个工作周期中；由此一个存储器的系统工作周期分为两部分：前半部分用于正常读写或保持；后半部分用于刷新。这种方式增加了系统的存取周期，降低了整机速度，优点是没有死区。
* 异步刷新：是前两种方法的结合，既能缩短死时间，又能充分利用最大刷新间隔为2ms的特点。将刷新周期除以行数，得到两次刷新操作之间的时间间隔t，利用逻辑电路每隔时间t产生一次刷新请求，这样可以避免使CPU连续等待过长时间，并且减少刷新次数。

刷新对CPU是透明的，不依赖于外部的访问；DRAM刷新的是行，由芯片内部自行生成行地址。

**存储芯片内部的结构**



### 只读存储器

类型：掩膜式、一次可编程只读、可擦除可编程只读、闪存、固态硬盘。





## 主存储器与CPU的连接

### 连接原理

* 主存通过数据总线、地址总线和控制总线与CPU相连
* 数据总线的位数与工作频率的乘积正比于数据传输率
* 地址总线的位数取决于可寻址的最大内存空间
* 控制总线（读/写）指出本次总线周期的类型以及本次输入/输出操作完成的时刻

### 主存容量的扩展

**位扩展法**

对**字长**进行补充，即增加存储单元的字长，使得**数据位数**与CPU的数据线数相等。

仅仅采用位扩展时，各芯片连接地址线的方式相同，但连接数据线的方式不同，片选信号要连到所有芯片。

eg：利用8片8K*1位的RAM芯片组成8K\*8位的存储器。

**字扩展法**

增加存储器中存储单元（字）的数量，位数不变。字扩展将芯片的地址线、数据线、读写控制线相并联，由片选信号区分各芯片的地址范围。相当于**增加地址线的数量**。

仅采用字扩展时，各芯片连接地址线的方式相同，连接数据线的方式也相同，但某个时刻只需要选中部分芯片，所以通过**片选**芯片或采用**译码器**设计连接到相应的芯片。

**字位同时扩展**

既改变字长，又改变地址数。

### 存储芯片的地址分配和片选

CPU实现**对存储单元的访问**，首先要选择存储芯片，即进行**片选**，然后为选中的芯片依地址码选择相应的存储单元，进行数据的存储，即进行**字选**。片内的字选通常由CPU送出的N条低地址线完成，地址线直接接到所有存储芯片的地址输入端。

片选和字选都相当于通过地址线进行选择。

片选信号的产生分为线选法和译码片选法。

**线选法**

用除了片内寻址外的高位地址线直接分别连接到各个存储芯片的片选端，当某地址线信息位0时，选中与之对应的存储芯片。片选地址线每次寻址时只能有一位有效，不允许同时多位有效。

缺点：地址空间不连续，不能充分利用系统的存储器空间，造成地址资源的浪费。

**译码片选法**

用除片内寻址外的高位地址线通过地址译码器芯片产生片选信号。

## 双端口RAM和多模块存储器

为了提高CPU访问存储器的速度，使用双端口存储器、多模块存储器等技术。

### 双端口RAM

一个存储器有左右两个独立的端口，分别具有两组相互独立的地址线、数据线和读写控制线。允许两个



### 多模块存储器









## 高速缓冲存储器





## 虚拟存储器

主存和辅存共同构成了虚拟存储器。



